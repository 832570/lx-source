## Lx-Source/更新日志

#### 2023-12-22 v1.0.2-b0.4 (beta)
<!-- + 没有功能更新，几个未来的想法
   - 利用缓存信息制作数据库，可通过api搜索音乐
   - 修改Lx-Music支持通过脚本新增搜索源 -->
+ update 更新:
   - 给CacheQuery加个sync.Pool，提高并发分配效率
   - 请求验证改为在初始化时载入，降低每次判断性能损耗
   <!-- - (现在内存缓存和文件缓存的响应速度差距约为200µs) -->
+ feature 功能:
   - 临时链生成仍将推迟
+ bugfix 修复:
   - 临时解决预定义(*Loger).NewGroup()无法输出到FileLoger问题
+ 注：
   - 如果非调试使用建议关闭控制台日志输出 [Main].Print=false，可少量提升io性能 (不影响文件日志记录)

#### 2023-12-19 1.0.2-b0.3 (dev)
+ 增加dev分支，日常开发，稳定了再合main，防止临时补充更新情况
+ 上次补充更新内容：将error.mp3换成远程连接
   - 洛雪客户端似乎无法识别Base64编码后的音频文件
   - 待解决问题：无法获取真实请求URL，如套一层Nginx或分路径反代，只能依赖手动配置的 [Cache].Local_Bind 确定外部地址
+ zTool:
   - 略微降低FileLogs缓存大小，防止异常退出丢**太多**日志情况 (TODO: Error及以上情况强制刷新缓冲区)
   - cmd: 优化io.Copy缓存问题
+ (未完成) 临时链生成功能 (需要维护双倍的映射表，实际速度可能减慢)
+ (实验性) [Main].SysLev 尝试调高程序优先级以解决windows下最小化降低资源分配问题

#### 2023-12-(17-18) 1.0.2-β0.2 (beta)
+ 脚本增加请求耗时输出
+ 优化zTool文件下载逻辑
+ 链接缓存由Source上移至Router级 (为临时链实现基础)
+ 完善缓存规则
   - 查询成功将链接写入内存，保留一小时 (MemCache HIT)
   - 解析错误将空字符串写入内存，阻止请求10分钟 (MemCache Reject)
   + 可提升后续重复查询响应速度 (实际效果不明显，后端几十µs的差距)
+ 防止自动换源机制瞎查，解析失败返回一段提示语音
   ```
   非常抱歉，
   本音频可能由以下原因导致无法正常播放，

   不支持的平台或音质，
   触发风控或专辑单独收费，
   缓存文件已被删除，
   实际音质不匹配，

   --洛雪自定义源
   （Lx-Source）
   ```
#### ~2023-12-16
+ 参考Python版移植部分功能
+ 完善、优化逻辑
+ 发布源码
#### 2023-10-21
+ 立项制作
